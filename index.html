<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tablero de Madera de Olivo - Tienda Online</title>
    <meta name="description" content="Tablero de madera de olivo maciza, hecho a mano en Espa√±a por un artesano personalmente. Personaliza tama√±o y cantos. Env√≠o gratis en Espa√±a. Garant√≠a de 3 a√±os.">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="icon-192.png">
    <script src="https://js.stripe.com/v3/"></script>
<style>
    /* minimal styling */
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#111}
    body{margin:0}
    header, section, footer{padding:1.25rem;border-bottom:1px solid #eee}
    header{background:#fafafa}
    footer{background:#fafafa}

    /* navigation buttons (hidden by default) */
    .mobile-nav{display:none;position:fixed;left:0;right:0;bottom:12px;pointer-events:auto;z-index:40}
    .mobile-nav .wrap{max-width:640px;margin:0 auto;display:flex;gap:.5rem;justify-content:center;padding:0 1rem}
    .mobile-nav button{padding:.6rem .9rem;border-radius:8px;border:1px solid #ccc;background:#fff}

    /* page indicators (dots + numeric) */
    .page-indicators{display:none}
    .page-indicators .dots{display:flex;gap:.4rem}
    .page-indicators span{width:8px;height:8px;border-radius:50%;background:#ccc;display:inline-block}
    .page-indicators span.active{background:#000}
    .page-indicators .count{margin-left:.6rem;font-size:.9rem;color:#333}

    /* MOBILE: make each section occupy the viewport and show only the active one */
    @media (max-width:768px){
      html,body{height:100%; margin: 0; padding: 0; overflow: hidden;}
      
      /* Fix header and footer positioning */
      header, footer{
        position: fixed;
        left: 0;
        right: 0;
        z-index: 20;
        transition: transform 0.3s ease-in-out;
        padding: 1rem;
      }
      
      header{
        top: 0;
        transform: translateY(0);
      }
      
      footer{
        bottom: 0;
        transform: translateY(0);
      }
      
      header.hidden{
        transform: translateY(-100%);
      }
      
      footer.hidden{
        transform: translateY(100%);
      }

      /* Fix section positioning to account for header/footer */
      section{
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        box-sizing: border-box;
        overflow: auto;
        border-bottom: 0;
        padding: 5rem 1.25rem 4rem 1.25rem; /* Adjusted padding to account for header/footer */
        height: 100vh;
      }
      
      section.active{
        display: block;
      }
      
      .mobile-nav{
        display: block;
        position: fixed;
        bottom: 20px;
        left: 0;
        right: 0;
        z-index: 50;
      }
      
      .page-indicators{
        display: flex;
        position: fixed;
        bottom: 70px;
        left: 0;
        right: 0;
        justify-content: center;
        align-items: center;
        gap: .5rem;
        z-index: 45;
      }
    }
</style>

</head>
<body>
  <header id="siteHeader">

        <h1>Tablero de Madera de Olivo</h1>
        <p>Artesan√≠a espa√±ola - Personalizable - Env√≠o gratis</p>
        <button id="installBtn">Instalar App</button>
        <div id="cartCount">Carrito: <span>0</span></div>
  </header>


  <!-- Pantalla 1: Uso -->
  <section id="s1" class="panel">
           <h2>1. Tipo de tablero</h2>
            <p>¬øPara qu√© usar√°s el tablero? Algunos usos requieren tratamiento especial.</p>
            <div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="tabletop" id="uso-tabletop" checked>
                        Encimera de mesa (+0‚Ç¨)
                    </label>
                </div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="kitchen-countertop" id="uso-kitchen-countertop">
                        Encimera de cocina (+100‚Ç¨ - tratamiento especial)
                    </label>
                </div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="kitchen-island" id="uso-kitchen-island">
                        Isla de cocina (+150‚Ç¨ - tratamiento reforzado)
                    </label>
                </div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="bathroom-countertop" id="uso-bathroom-countertop">
                        Encimera de ba√±o (+80‚Ç¨ - tratamiento anti-humedad)
                    </label>
                </div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="shelf" id="uso-shelf">
                        Estante (+0‚Ç¨)
                    </label>
                </div>
                <div>
                    <label>
                        <input type="radio" name="uso" value="other" id="uso-other-radio">
                        Otro (especificar) (+0‚Ç¨)
                    </label>
                    <input type="text" id="uso-otro-input" placeholder="¬øPara qu√© lo usar√°s?">
                </div>
          </div>
  </section>

  <!-- Pantalla 2: Dimensiones -->
  <section id="s2" class="panel">
    <h2>2. Dimensiones</h2>
            <p>Los tableros se fabrican a mano con madera de olivo maciza por encargo. Personaliza tu tablero seg√∫n tus especificaciones.</p>
            <div>
                <label for="thickness">Grosor (cm):</label>
                 <p>
                     <select id="thickness">
                    <option value="3">3 cm - 900‚Ç¨/m¬≤</option>
                    <option value="5" selected>5 cm - 1200‚Ç¨/m¬≤</option>
                    <option value="7">7 cm - 1500‚Ç¨/m¬≤</option>
                     </select>
                 </p>
                
                <label for="length">Longitud (cm) | m√≠nimo 50 cm - m√°ximo 300 cm</label>
                <p>
                    <button type="button" onclick="changeValue('length', -10)">‚àí10</button>
                    <button type="button" onclick="changeValue('length', -1)">‚àí1</button>
                    <input type="number" id="length" min="50" max="300" value="80" oninput="validateInput(this)">
                    <button type="button" onclick="changeValue('length', 1)">+1</button>
                    <button type="button" onclick="changeValue('length', 10)">+10</button>
                </p>
                
                <label for="width">Ancho (cm) | m√≠nimo 20 cm - m√°ximo 100 cm</label>
                <p>
                    <button type="button" onclick="changeValue('width', -10)">‚àí10</button>
                    <button type="button" onclick="changeValue('width', -1)">‚àí1</button>
                    <input type="number" id="width" min="20" max="100" value="30" oninput="validateInput(this)">
                    <button type="button" onclick="changeValue('width', 1)">+1</button>
                    <button type="button" onclick="changeValue('width', 10)">+10</button>
                </p>
            </div>
  </section>

  <!-- Pantalla 3: Cantos -->
  <section id="s3" class="panel">
    <h2>3. Cantos</h2>
      <p>Elige el tipo de canto para cada lado: <strong>recto</strong> (cortado a m√°quina, +0‚Ç¨) o <strong>r√∫stico</strong> (borde natural del √°rbol, +50‚Ç¨ por canto).</p>
            <div>
                <svg id="board-svg" role="img" aria-label="Diagrama de configuraci√≥n de cantos" width="240" height="180" viewBox="0 0 240 180">
                    <path id="edge-north" d="M30,60 H210" stroke="#999" stroke-width="6" fill="none"/>
                    <path id="edge-east" d="M210,60 V140" stroke="#999" stroke-width="6" fill="none"/>
                    <path id="edge-south" d="M210,140 H30" stroke="#999" stroke-width="6" fill="none"/>
                    <path id="edge-west" d="M30,140 V60" stroke="#999" stroke-width="6" fill="none"/>
                    <text x="120" y="20" text-anchor="middle" font-size="12" fill="#666">DIAGRAMA DE CANTOS</text>
                    <text x="120" y="48" text-anchor="middle" font-size="13" fill="#333">Trasero</text>
                    <text x="225" y="43" text-anchor="start" font-size="13" fill="#333" transform="rotate(90,205,60)">Derecho</text>
                    <text x="120" y="164" text-anchor="middle" font-size="13" fill="#333">Frontal</text>
                    <text x="-55" y="63" text-anchor="start" font-size="13" fill="#333" transform="rotate(-90,15,60)">Izquierdo</text>
                </svg>
                
                <div>
                    <p>
                        <strong>B</strong> - Canto Trasero<br>
                        <label>
                            <input type="radio" name="edge-north" value="recto" checked onchange="updateEdge('north')">
                            Recto (+0‚Ç¨)
                        </label>
                        <label>
                            <input type="radio" name="edge-north" value="rustico" onchange="updateEdge('north')">
                            R√∫stico (+50‚Ç¨)
                        </label>
                    </p>
                    
                    <p>
                        <strong>R</strong> - Canto Derecho<br>
                        <label>
                            <input type="radio" name="edge-east" value="recto" checked onchange="updateEdge('east')">
                            Recto (+0‚Ç¨)
                        </label>
                        <label>
                            <input type="radio" name="edge-east" value="rustico" onchange="updateEdge('east')">
                            R√∫stico (+50‚Ç¨)
                        </label>
                    </p>
                    
                    <p>
                        <strong>F</strong> - Canto Frontal<br>
                        <label>
                            <input type="radio" name="edge-south" value="recto" checked onchange="updateEdge('south')">
                            Recto (+0‚Ç¨)
                        </label>
                        <label>
                            <input type="radio" name="edge-south" value="rustico" onchange="updateEdge('south')">
                            R√∫stico (+50‚Ç¨)
                        </label>
                    </p>
                    
                    <p>
                        <strong>L</strong> - Canto Izquierdo<br>
                        <label>
                            <input type="radio" name="edge-west" value="recto" checked onchange="updateEdge('west')">
                            Recto (+0‚Ç¨)
                        </label>
                        <label>
                            <input type="radio" name="edge-west" value="rustico" onchange="updateEdge('west')">
                            R√∫stico (+50‚Ç¨)
                        </label>
                    </p>
                </div>
                
                <div id="edgesSummary"></div>
            </div>
  </section>
<!-- Pantalla 4: Resumen y Precio -->
<section id="s4" class="panel">
    <h2>4. Resumen y Precio</h2>
    <div id="productSummary">
        <h3>Producto configurado:</h3>
        <p><strong>Producto:</strong> <span id="productType">--</span></p>
        <p><strong>Dimensiones:</strong> <span id="productDimensions">--</span></p>
        <p><strong>Cantos:</strong> <span id="productEdges">--</span></p>
        <p><strong>SKU:</strong> <span id="productSKU">--</span></p>
        <p><strong>Producto configurado:</strong> <span id="productConfigured">--</span></p>              
        <hr>
        
        <h3>Desglose de precio:</h3>
        <table>
            <tr>
                <td>Precio base (superficie √ó grosor):</td>
                <td align="right"><span id="priceBase">0.00</span> ‚Ç¨</td>
            </tr>
            <tr>
                <td>Cantos r√∫sticos (<span id="rusticEdgesCount">0</span> √ó 50‚Ç¨):</td>
                <td align="right"><span id="priceEdges">0.00</span> ‚Ç¨</td>
            </tr>
            <tr>
                <td>Tratamiento especial (uso):</td>
                <td align="right"><span id="priceUsage">0.00</span> ‚Ç¨</td>
            </tr>
            <tr>
                <td colspan="2"><hr></td>
            </tr>
            <tr>
                <td><strong>PRECIO TOTAL:</strong></td>
                <td align="right"><strong><span id="priceDisplay">0.00</span> ‚Ç¨</strong></td>
            </tr>
        </table>
    </div>
</section>
  <!-- Pantalla 5: Carrito -->
  <section id="s5" class="panel">

    <h2>5. Carrito</h2>
            <p>A√±ade el tablero configurado al carrito. Puedes a√±adir m√∫ltiples tableros con diferentes configuraciones.</p>
            <div>
                <button id="addToCart">
                    ‚ûï A√±adir al Carrito
                </button>
                <p><small>Hecho a mano ‚Ä¢ Env√≠o gratis en Espa√±a ‚Ä¢ Garant√≠a 5 a√±os</small></p>
            </div>
            <div>
                <div id="cartItems">
                    <p>Tu carrito est√° vac√≠o.</p>
                </div>
                <div id="totalPrice"></div>
                <button id="clearCart">Vaciar Carrito</button>
            </div>
  </section>

  <!-- Pantalla 6: Pago -->
  <section id="s6" class="panel">
    <h2>6. Pago</h2>
    <p>Procede al pago seguro con Stripe. <strong>Pedido m√≠nimo: 175 ‚Ç¨</strong></p>
            <div>
                <button id="checkout" disabled>
                    üí≥ Completar Pedido ‚Üí
                </button>
                <p><small>Pago 100% Seguro ‚Ä¢ Entrega en 3 Semanas</small></p>
            </div>
  </section>






  <footer id="siteFooter">
    <small>Footer content ‚Äî visible on desktop.</small>
  </footer>

  <!-- Prev/Next navigation (only shown on small screens via CSS) -->
  <div class="mobile-nav" aria-hidden="false">
    <div class="wrap">
      <button id="prevBtn" aria-label="Previous">‚óÄ Previous</button>
      <button id="nextBtn" aria-label="Next">Next ‚ñ∂</button>
    </div>
  </div>

  <!-- Page indicators (dots + numeric counter) -->
  <div class="page-indicators" aria-hidden="false">
    <div class="dots" aria-hidden="true"></div>
    <div class="count" aria-hidden="true"></div>
  </div>

<script>
    (function(){
      // small helper: swipe listeners
      function addSwipeListeners(el, onSwipeLeft, onSwipeRight){
        let startX = null;
        let startY = null;
        el.addEventListener('touchstart', e=>{
          if(e.touches && e.touches.length === 1){
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
          }
        }, {passive:true});
        el.addEventListener('touchend', e=>{
          if(startX === null) return;
          const dx = e.changedTouches[0].clientX - startX;
          const dy = e.changedTouches[0].clientY - startY;
          // ignore mostly-vertical swipes
          if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 40){
            if(dx < 0) onSwipeLeft(); else onSwipeRight();
          }
          startX = null; startY = null;
        }, {passive:true});
      }

      const panels = Array.from(document.querySelectorAll('section.panel'));
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const indicators = document.querySelector('.page-indicators');
      const dotsContainer = indicators.querySelector('.dots');
      const countEl = indicators.querySelector('.count');
      const header = document.getElementById('siteHeader');
      const footer = document.getElementById('siteFooter');
      let index = 0;

      const mq = window.matchMedia('(max-width:768px)');

      // update indicators (dots + count)
      function updateIndicators(){
        dotsContainer.innerHTML = panels.map((_,i)=>`<span class="${i===index?'active':''}" aria-hidden="true"></span>`).join('');
        countEl.textContent = `${index+1} / ${panels.length}`;
      }

      // show/hide header/footer on mobile
      function updateHeaderFooterForMobile(isMobile){
        if(!isMobile){
          header.classList.remove('hidden');
          footer.classList.remove('hidden');
          return;
        }
        // Show header/footer by default on mobile
        header.classList.remove('hidden');
        footer.classList.remove('hidden');
      }

      // main mobile view updater
      function updateMobileView(){
        const isMobile = mq.matches;
        updateHeaderFooterForMobile(isMobile);

        if(!isMobile){
          // desktop: show all sections
          panels.forEach(p => {
            p.classList.remove('active');
            p.style.position = '';
            p.style.height = '';
          });
          document.querySelector('.mobile-nav').style.display = 'none';
          indicators.style.display = 'none';
          document.body.style.overflow = '';
          return;
        }

        // mobile: only show the active panel
        panels.forEach((p,i)=> {
          p.classList.toggle('active', i === index);
          p.style.position = 'fixed';
          p.style.height = '100vh';
        });
        
        document.querySelector('.mobile-nav').style.display = 'block';
        indicators.style.display = 'flex';
        document.body.style.overflow = 'hidden';

        prevBtn.disabled = index === 0;
        nextBtn.disabled = index === panels.length - 1;
        updateIndicators();

        // update URL hash (non-destructive)
        try{ history.replaceState && history.replaceState(null, '', '#'+panels[index].id); }catch(e){}
      }

      // navigation handlers
      prevBtn.addEventListener('click', ()=>{ if(index > 0){ index--; updateMobileView(); }});
      nextBtn.addEventListener('click', ()=>{ if(index < panels.length -1){ index++; updateMobileView(); }});

      // keyboard support for mobile-like navigation
      window.addEventListener('keydown', (e)=>{
        if(!mq.matches) return; // only when mobile
        if(e.key === 'ArrowRight' || e.key === 'PageDown') { if(index < panels.length-1) { index++; updateMobileView(); }}
        if(e.key === 'ArrowLeft'  || e.key === 'PageUp')   { if(index > 0) { index--; updateMobileView(); }}
      });

      // react to viewport changes
      if(mq.addEventListener) mq.addEventListener('change', updateMobileView); else mq.addListener(updateMobileView);

      // attach swipe to each panel
      panels.forEach(p=> addSwipeListeners(p, ()=>{ if(index<panels.length-1){ index++; updateMobileView(); }}, ()=>{ if(index>0){ index--; updateMobileView(); }}));

      // initialize from hash if present
      const hash = location.hash.replace('#','');
      if(hash){
        const idx = panels.findIndex(p=>p.id === hash);
        if(idx >=0) index = idx;
      }

      // initial render
      updateMobileView();

      // Auto-hide header/footer on scroll with better logic
      let scrollTimeout;
      panels.forEach(p=>{
        p.addEventListener('scroll', ()=>{
          if(!mq.matches) return;
          
          clearTimeout(scrollTimeout);
          
          // Show header/footer when scrolling starts
          header.classList.remove('hidden');
          footer.classList.remove('hidden');
          
          // Hide after scrolling stops
          scrollTimeout = setTimeout(() => {
            if(p.scrollTop > 50) {
              header.classList.add('hidden');
            }
            if(p.scrollHeight - p.clientHeight - p.scrollTop > 50) {
              footer.classList.add('hidden');
            }
          }, 1500);
        }, {passive:true});
        
        // Show header/footer when touch starts
        p.addEventListener('touchstart', () => {
          header.classList.remove('hidden');
          footer.classList.remove('hidden');
          clearTimeout(scrollTimeout);
        }, {passive:true});
      });
    })();
</script>

<script src="app.js"></script>
</body>
</html>
